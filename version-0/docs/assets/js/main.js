const createBtn=document.querySelector(".js-create-btn"),hiddenBoxElement=document.querySelector(".js-display"),inputsTextConfig=[{inputClass:".js-input-name",cardClass:".js-card-name",defaultValue:"Nombre apellidos",cardPrefix:"",cardElementAttribute:"innerHTML"},{inputClass:".js-input-job",cardClass:".js-card-job",defaultValue:"Profesión",cardPrefix:"",cardElementAttribute:"innerHTML"},{inputClass:".js-input-email",cardClass:".js-card-email",defaultValue:"",cardPrefix:"mailto:",cardElementAttribute:"href"},{inputClass:".js-input-phone",cardClass:".js-card-phone",defaultValue:"",cardPrefix:"tel:",cardElementAttribute:"href"},{inputClass:".js-input-linkedin",cardClass:".js-card-linkedin",defaultValue:"",cardPrefix:"https://www.linkedin.com/in/",cardElementAttribute:"href"},{inputClass:".js-input-github",cardClass:".js-card-github",defaultValue:"",cardPrefix:"https://github.com/",cardPrefixGithub:"@",cardElementAttribute:"href"}];function updateAllInputs(){saveInLocalStorage(),resetShareSection();for(const e of inputsTextConfig){console.log("Empiezo una nueva iteración del for con la configuración del elemento:",e);const t=document.querySelector(e.inputClass);console.log("Elemento del formulario:",e.inputClass,t);const r=document.querySelector(e.cardClass);console.log("Elemento del la tarjeta:",e.cardClass,r);let n=t.value;"innerHTML"===e.cardElementAttribute?(n=""===t.value?e.defaultValue:t.value,console.log("Valor por defecto:",e.defaultValue),console.log("Nuevo valor a poner en la tarjeta:",n),r.innerHTML=n):"href"===e.cardElementAttribute&&(""===t.value?n="#":inputsTextConfig[5]?(n=n.replace(e.cardPrefix,""),n=n.replace(e.cardPrefixGithub,""),n=e.cardPrefix+n):(n=n.replace(e.cardPrefix,""),n=e.cardPrefix+n),console.log("Valor del prefijo:",e.cardPrefix),console.log("Nuevo valor a poner en la tarjeta:",n),r.href=n),console.log("-------------------------------------------------")}}const inputTextElements=document.querySelectorAll(".js-input-text");for(const e of inputTextElements)e.addEventListener("keyup",updateAllInputs);const titlesAreaElement=document.querySelectorAll(".js-title");for(const e of titlesAreaElement)e.addEventListener("click",changeCollapsable);function changeCollapsable(e){const t=e.currentTarget.parentNode,r=document.querySelectorAll(".js-container");for(const e of r)t===e?e.classList.toggle("collapsable__close"):e.classList.add("collapsable__close")}const paletteElements=document.querySelectorAll(".js-palette"),cardElement=document.querySelector(".js-card");function handlePalette(e){cardElement.classList.remove("palette-1","palette-2","palette-3","palette-4");const t=document.querySelector(".js-palette:checked").value;cardElement.classList.add("palette-"+t),console.log(t)}for(const e of paletteElements)e.addEventListener("change",handlePalette);handlePalette();const fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");let photo="";function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){photo=fr.result,updatePhoto(),saveInLocalStorage()}function updatePhoto(){const e=photo||"https://www.larata.cl/wp-content/uploads/2019/03/Peggy-Olson-1-700x525.jpg";profilePreview.style.backgroundImage=`url(${e})`,profileImage.style.backgroundImage=`url(${e})`}function fakeFileClick(){fileField.click()}function saveInLocalStorage(){const e={photo:photo,palette:document.querySelector(".js-palette:checked").value,name:document.querySelector(".js-input-name").value,job:document.querySelector(".js-input-job").value,email:document.querySelector(".js-input-email").value,phone:document.querySelector(".js-input-phone").value,linkedin:document.querySelector(".js-input-linkedin").value,github:document.querySelector(".js-input-github").value},t=JSON.stringify(e);localStorage.setItem("userData",t)}function getFromLocalStorage(){const e=localStorage.getItem("userData");if(null!==e){const t=JSON.parse(e);document.querySelector(".js-input-name").value=t.name,document.querySelector(".js-input-job").value=t.job,document.querySelector(".js-input-email").value=t.email,document.querySelector(".js-input-phone").value=t.phone,document.querySelector(".js-input-linkedin").value=t.linkedin,document.querySelector(".js-input-github").value=t.github,photo=t.photo;const r=document.querySelectorAll(".js-palette");for(const e of r)e.value===t.palette&&(e.checked=!0);updateAllInputs(),handlePalette(),updatePhoto()}}uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage),getFromLocalStorage();const submitElement=document.querySelector(".js-submit");function handleSubmit(e){e.preventDefault()}submitElement.addEventListener("submit",handleSubmit);const cardResultElement=document.querySelector(".js-card-result"),twitterElement=document.querySelector(".twitterLink"),requiredElement=document.querySelector(".js-required");function getCardData(){return{photo:photo,palette:parseInt(document.querySelector(".js-palette:checked").value),name:document.querySelector(".js-input-name").value,job:document.querySelector(".js-input-job").value,email:document.querySelector(".js-input-email").value,phone:document.querySelector(".js-input-phone").value,linkedin:document.querySelector(".js-card-linkedin").href.replace("https://www.linkedin.com/in/",""),github:document.querySelector(".js-card-github").href.replace("https://github.com/","")}}function requiredText(){const e=photo,t=document.querySelector(".js-input-name").value,r=document.querySelector(".js-input-job").value,n=document.querySelector(".js-input-email").value,l=document.querySelector(".js-input-phone").value,a=document.querySelector(".js-input-linkedin").value,o=document.querySelector(".js-input-github").value;return""===t?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n    Por favor, rellena correctamente el nombre.',!1):""===r?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n   Por favor, rellena correctamente el puesto.',!1):""===l?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n    Por favor, rellena correctamente el teléfono.',!1):"https://decider.com/wp-content/uploads/2015/05/peggy-survivor-lead.png?w=1156&h=862&crop=1"===e||""===e?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n    Por favor, añade una imagen.',!1):""===n?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n    Por favor, rellena correctamente el email.',!1):""===a?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n    Por favor, rellena correctamente el usuario de Linkedin.',!1):""===o?(requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>\n    Por favor, rellena correctamente el usuario de Github.',!1):(requiredElement.innerHTML="",!0)}function handleCreateBtn(e){if(e.preventDefault(),console.log("DATOS API",getCardData()),!0===requiredText()){const e="https://awesome-profile-cards.herokuapp.com/card",t=getCardData();fetch(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{console.log("Server response:",e),!0===e.success?(createBtn.style.backgroundColor="#d5d5d5",hiddenBoxElement.classList.remove("js-hidden"),cardResultElement.innerHTML="Haz click aquí para ver tu tarjeta",cardResultElement.href=e.cardURL):requiredElement.innerHTML='<i class="fas fa-exclamation-circle"></i>Lo sentimos, hemos tenido algún problema con el servidor. Prueba más tarde. Error: '+e.error})}}function handleTwitterBtn(){const e=encodeURIComponent("¡Echa un vistazo a la tarjeta que me he creado con Mad Women Profile Cards!"),t=encodeURIComponent("Adalab,promoL,MadWomen,frontend"),r=cardResultElement.href;twitterElement.href=`https://twitter.com/intent/tweet?text=${e}&url=${r}&hashtags=${t}`}function resetShareSection(){createBtn.style.backgroundColor="#cc1517",hiddenBoxElement.classList.add("js-hidden")}createBtn.addEventListener("click",handleCreateBtn),twitterElement.addEventListener("click",handleTwitterBtn);const resetButtonElement=document.querySelector(".js-reset"),nameCardElement=document.querySelector(".js-card-name"),jobCardElement=document.querySelector(".js-card-job"),emailCardElement=document.querySelector(".js-card-email"),phoneCardElement=document.querySelector(".js-card-phone"),linkedinCardElement=document.querySelector(".js-card-linkedin"),githubCardElement=document.querySelector(".js-card-github");function resetInfo(){resetShareSection(),document.querySelector(".form").reset(),nameCardElement.innerHTML="Nombre Apellido",jobCardElement.innerHTML="Profesión",profilePreview.style.backgroundImage="",photo="https://decider.com/wp-content/uploads/2015/05/peggy-survivor-lead.png?w=1156&h=862&crop=1",profileImage.style.backgroundImage="url('https://decider.com/wp-content/uploads/2015/05/peggy-survivor-lead.png?w=1156&h=862&crop=1')",phoneCardElement.href="",emailCardElement.href="",linkedinCardElement.href="",githubCardElement.href="",requiredElement.innerHTML="",localStorage.removeItem("userData"),cardElement.classList.remove("palette-1","palette-2","palette-3");document.querySelector(".js-palette:checked");cardElement.classList.add("palette-1"),handlePalette()}resetButtonElement.addEventListener("click",resetInfo);